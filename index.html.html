<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ahmed Maher - Portfolio</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcode/1.5.1/qrcode.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
html { scroll-behavior: smooth; }
body { margin: 0; padding: 0; font-family: 'Inter', sans-serif; display: flex; align-items: center; justify-content: center; min-height: 100vh; background-color: #111827; }
#app-frame { position: relative; width: 100%; height: 95vh; max-width: 450px; background-color: #f0f0f0; border-radius: 1.5rem; box-shadow: 0 0 40px rgba(0,0,0,0.4); overflow-y: scroll; overflow-x: hidden; -ms-overflow-style: none; scrollbar-width: none; }
#app-frame::-webkit-scrollbar { display: none; }
.image-snap-container { width: 100%; min-height: 100%; display: flex; flex-direction: column; align-items: center; justify-content: flex-start; flex-shrink: 0; position: relative; }
.contact-card { background-color: white; border-radius: 1.5rem; box-shadow: 0 10px 25px rgba(0,0,0,0.1); padding: 1.5rem 1rem 2rem 1rem; width: 90%; max-width: 400px; margin-top: 2rem; position: relative; z-index: 10; display: flex; flex-direction: column; align-items: center; text-align: center; }
.contact-link { font-size: 1rem; color: #3182ce; text-decoration: none; margin-top: 0.25rem; margin-bottom: 0; display: block; word-break: break-all; }
.contact-link:hover { text-decoration: underline; }
.qr-code-unit { display: flex; flex-direction: column; align-items: center; justify-content: center; width: 50%; }
.logo-link { display: flex; flex-direction: column; align-items: center; margin: 0.25rem 0.25rem; text-decoration: none; }
.logo-link img { width: 40px; height: 40px; border-radius: 8px; object-fit: contain; }
#social-links-container a i { font-size: 1.25rem; }
.qr-modal-overlay { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.6); display: flex; align-items: center; justify-content: center; z-index: 100; backdrop-filter: blur(4px); -webkit-backdrop-filter: blur(4px); }
.qr-modal-content { background-color: white; border-radius: 1rem; padding: 1.5rem; box-shadow: 0 10px 25px rgba(0,0,0,0.2); display: flex; flex-direction: column; align-items: center; }
.qr-modal-close { position: absolute; top: 1rem; right: 1.5rem; font-size: 2rem; color: white; cursor: pointer; line-height: 1; font-weight: 300; }
.hidden { display: none; }
.qr-code-unit.clickable { cursor: pointer; transition: transform 0.2s; border-radius: 0.5rem; padding-top: 0.5rem; padding-bottom: 0.5rem; }
.qr-code-unit.clickable:hover { transform: scale(1.05); background-color: rgba(0,0,0,0.03); }
.profile-modal-content { background-color: white; border-radius: 1rem; box-shadow: 0 10px 25px rgba(0,0,0,0.2); display: flex; flex-direction: column; text-align: center; width: 90%; max-width: 300px; overflow: hidden; }
.profile-img-clickable { cursor: pointer; transition: transform 0.2s ease; }
.profile-img-clickable:hover { transform: scale(1.03); }
.qr-modal-btn { background-color: #f3f4f6; color: #1f2937; font-weight: 600; padding: 0.5rem 1rem; border-radius: 0.5rem; display: inline-flex; align-items: center; transition: background-color 0.2s; }
.qr-modal-btn:hover { background-color: #e5e7eb; }
    </style>
    <script id="tailwind-config">
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'landing-bg-top': '#0269a6', 
                        'landing-bg-bottom': '#f0f0f0',
                        'name-text': '#f3f4f6',
                        'title-text': '#d1d5db',
                        'gallery-bg': '#1f2937',
                    }
                }
            }
        }
    </script>
</head>

<body>
    <main id="app-frame">
        <div id="landing-page-container" class="image-snap-container bg-gradient-to-b from-landing-bg-top to-landing-bg-bottom justify-start">
            
            <div id="landing-bg-top-container" class="absolute top-0 left-0 w-full h-[50%] bg-landing-bg-top z-0">
            </div>
            <div class="absolute bottom-0 left-0 w-full h-[50%] bg-landing-bg-bottom z-0"></div>

            <div class="relative z-10 flex flex-col items-center mt-6 sm:mt-8 px-4"> 
                <img id="main-profile-img" src="#" alt="Profile Picture" 
                     class="w-28 h-28 sm:w-32 sm:h-32 rounded-full object-cover border-4 border-white shadow-lg mb-2"
                     onerror="this.onerror=null; this.src='https://placehold.co/150x150/505050/FFFFFF?text=Photo+Missing';"
                >
                <h1 id="profile-name" class="text-xl font-bold text-name-text text-center break-words mt-0">Loading...</h1>
                <p id="profile-title" class="text-sm text-title-text text-center break-words mt-0.5"></p>
            </div>
            
            <div class="contact-card mt-4 mb-4">  
                
                <div class="flex justify-center w-full space-x-8 mt-2">
                    <a id="whatsapp-icon-link" href="#" target="_blank" title="WhatsApp Chat" class="flex flex-col items-center">
                        <i class="fab fa-whatsapp contact-icon text-green-500 mb-1 text-2xl"></i>
                    </a>
                    <a id="wechat-icon-link" href="#" target="_blank" title="WeChat Chat" class="flex flex-col items-center">
                        <i class="fab fa-weixin contact-icon text-green-600 mb-1 text-2xl"></i>
                    </a>
                </div>

                <div class="flex flex-col items-center mb-4"> 
                    <a id="primary-contact-number-link" href="#" class="contact-link font-bold break-words text-center text-lg text-blue-600">
                        <span id="primary-contact-number">N/A</span>
                    </a>
                </div>

                <div id="social-links-container" class="flex flex-wrap justify-center gap-4 py-2 border-t border-b border-gray-100 w-full my-3">
                </div>

                <div id="main-web-link-block" class="flex flex-col items-center mb-3 w-full px-2"> 
                    <i class="fas fa-globe contact-icon text-gray-700 mb-1"></i>
                    <div id="web-links-list" class="flex flex-col items-center w-full space-y-1">
                    </div>
                </div>
                
                <div class="flex flex-col items-center mb-8"> 
                    <i class="fas fa-envelope contact-icon text-red-500 mb-1"></i>
                    <a id="email-link" href="#" class="contact-link"></a>
                </div>
                
                <div class="flex justify-between w-full max-w-xs px-2 mt-4 mb-4">
                    <div id="qr-code-profile-container" class="qr-code-unit">
                        <div style="width: 120px; height: 120px;">
                            <canvas id="qr-code-profile-canvas" width="120" height="120"></canvas>
                        </div>
                        <p class="text-xs text-gray-600 mt-1 font-semibold">Check Profile</p>
                    </div>

                    <div id="qr-code-wechat-container" class="qr-code-unit">
                        <div style="width: 120px; height: 120px;">
                            <canvas id="qr-code-wechat-canvas" width="120" height="120"></canvas>
                        </div>
                        <p class="text-xs text-gray-600 mt-1 font-semibold">We chat</p>
                    </div>
                </div>

                <div id="brand-logos-container" class="w-full mt-2 pt-4 border-t border-gray-100">
                    <div id="brand-logos-links" class="flex flex-wrap justify-center gap-x-4">
                    </div>
                </div>
            </div>
        </div>

        <div id="qr-modal" class="qr-modal-overlay hidden">
            <span id="qr-modal-close-btn" class="qr-modal-close">&times;</span>
            <div class="qr-modal-content">
                <canvas id="modal-qr-canvas" width="256" height="256"></canvas>
                <p id="modal-qr-text" class="text-base text-gray-800 mt-3 font-semibold"></p>
                <div id="copy-success-msg" class="text-sm text-green-600 mt-2 hidden">Link copied to clipboard!</div>
                <div class="flex space-x-4 mt-4">
                    <button id="qr-copy-btn" class="qr-modal-btn">
                        <i class="fas fa-copy mr-2"></i>Copy Link
                    </button>
                    <button id="qr-share-btn" class="qr-modal-btn hidden">
                        <i class="fas fa-share mr-2"></i>Share
                    </button>
                </div>
            </div>
        </div>

        <div id="profile-modal" class="qr-modal-overlay hidden">
            <span id="profile-modal-close-btn" class="qr-modal-close">&times;</span>
            <div class="profile-modal-content">
                <img id="modal-profile-img" src="#" alt="Profile Picture" class="w-full h-auto">
                <div class="p-4 w-full">
                    <h1 id="modal-profile-name" class="text-xl font-bold text-gray-800 text-center break-words"></h1>
                    <p id="modal-profile-title" class="text-sm text-gray-600 text-center break-words mt-0.5"></p>
                    <a id="modal-profile-number" href="#" class="contact-link font-bold break-words text-center text-lg text-blue-600 mt-3"></a>
                    <div id="modal-profile-bio-container" class="hidden mt-4 border-t pt-4">
                        <p id="modal-profile-bio" class="text-sm text-gray-600 text-left whitespace-pre-wrap"></p>
                    </div>
                </div>
            </div>
        </div>
    </main>
    
    <script>
        let appContactData = {};
        let currentModalQrUrl = '';
        function showQrModal(canvasId, text, url) {
            const modal = document.getElementById('qr-modal');
            const modalCanvas = document.getElementById('modal-qr-canvas');
            const modalText = document.getElementById('modal-qr-text');
            const sourceCanvas = document.getElementById(canvasId);
            if (!modal || !modalCanvas || !modalText || !sourceCanvas) return;
            currentModalQrUrl = url;
            const modalCtx = modalCanvas.getContext('2d');
            modalCtx.clearRect(0, 0, modalCanvas.width, modalCanvas.height);
            const img = new Image();
            img.onload = function() {
                modalCtx.drawImage(img, 0, 0, modalCanvas.width, modalCanvas.height);
            };
            img.src = sourceCanvas.toDataURL();
            modalText.textContent = text;
            modal.classList.remove('hidden');
            const shareBtn = document.getElementById('qr-share-btn');
            if (navigator.share) {
                shareBtn.classList.remove('hidden');
            } else {
                shareBtn.classList.add('hidden');
            }
            document.getElementById('copy-success-msg').classList.add('hidden');
        }
        function hideQrModal() {
            const modal = document.getElementById('qr-modal');
            if (modal) modal.classList.add('hidden');
        }
        function showProfileModal() {
            const modal = document.getElementById('profile-modal');
            if (!modal) return;
            const modalImg = document.getElementById('modal-profile-img');
            const modalName = document.getElementById('modal-profile-name');
            const modalTitle = document.getElementById('modal-profile-title');
            const modalNumber = document.getElementById('modal-profile-number');

            modalImg.src = document.getElementById('main-profile-img').src;
            modalName.textContent = document.getElementById('profile-name').textContent;
            modalTitle.textContent = document.getElementById('profile-title').textContent;
            
            const numberLink = document.getElementById('primary-contact-number-link');
            const numberSpan = document.getElementById('primary-contact-number');
            modalNumber.textContent = numberSpan.textContent;
            modalNumber.href = numberLink.href;
            
            modal.classList.remove('hidden');
        }
        function hideProfileModal() {
            const modal = document.getElementById('profile-modal');
            if (modal) modal.classList.add('hidden');
            const bioContainer = document.getElementById('modal-profile-bio-container');
            if (bioContainer) bioContainer.classList.add('hidden');
        }
        function renderQrCode(canvasId, url, text) {
            const qrCanvas = document.getElementById(canvasId);
            if (!qrCanvas) return;
            const qrContainer = qrCanvas.parentElement.parentElement;
            const qrTextElement = qrContainer.querySelector('p');
            const qrCtx = qrCanvas.getContext('2d');
            qrCtx.clearRect(0, 0, qrCanvas.width, qrCtx.height); 
            qrContainer.classList.remove('clickable');
            qrContainer.onclick = null;
            if (url && QRCode) {
                QRCode.toCanvas(qrCanvas, url, { width: 120, margin: 1, errorCorrectionLevel: 'H' }, function (error) {
                    if (error) console.error("QR Code Error:", error);
                });
                qrContainer.style.display = 'flex';
                qrTextElement.textContent = text;
                qrContainer.classList.add('clickable');
                qrContainer.onclick = () => showQrModal(canvasId, text, url);
            } else {
                qrContainer.style.display = 'none';
            }
            qrContainer.classList.add('qr-code-unit'); 
        }
        function setupLandingPage(contactData) { 
            const bgContainer = document.getElementById('landing-bg-top-container');
            const newBgValue = contactData.headerBG || '#0269a6';
            const isUrl = newBgValue.startsWith('http') || newBgValue.startsWith('/');
            if (isUrl) {
                bgContainer.style.backgroundColor = '';
                bgContainer.className = 'absolute top-0 left-0 w-full h-[50%] z-0';
                bgContainer.innerHTML = `
                    <img src="${newBgValue}" 
                         alt="Background image" 
                         class="w-full h-full object-cover">
                `;
            } else {
                bgContainer.innerHTML = '';
                bgContainer.style.backgroundColor = newBgValue; 
                bgContainer.className = 'absolute top-0 left-0 w-full h-[50%] z-0';
            }
            const profileImg = document.getElementById('main-profile-img');
            profileImg.src = contactData.mainImageURI;
            profileImg.classList.add('profile-img-clickable');
            profileImg.onclick = showProfileModal;

            document.getElementById('profile-name').textContent = contactData.name;
            document.getElementById('profile-title').textContent = contactData.title;
            const primaryNumberEl = document.getElementById('primary-contact-number');
            const primaryNumberLink = document.getElementById('primary-contact-number-link');
            const waIconLink = document.getElementById('whatsapp-icon-link');
            const wcIconLink = document.getElementById('wechat-icon-link');
            primaryNumberEl.textContent = contactData.whatsappNumber || 'N/A';
            const callingNumber = (contactData.whatsappNumber || '').replace(/[^0-9+]/g, '');
            primaryNumberLink.href = `tel:${callingNumber}`;
            waIconLink.href = contactData.whatsappUrl || 'javascript:void(0)';
            if (!contactData.whatsappUrl) waIconLink.removeAttribute('target'); else waIconLink.setAttribute('target', '_blank');
            wcIconLink.href = contactData.wechatUrl || 'javascript:void(0)';
            if (!contactData.wechatUrl) wcIconLink.removeAttribute('target'); else wcIconLink.setAttribute('target', '_blank');
            const emailLink = document.getElementById('email-link');
            emailLink.href = contactData.emailAddress ? `mailto:${contactData.emailAddress}` : '#';
            emailLink.textContent = contactData.emailAddress || 'N/A';
            const socialLinksContainer = document.getElementById('social-links-container');
            socialLinksContainer.innerHTML = ''; 
            const socialMap = [
                { key: 'linkedin', icon: 'fab fa-linkedin', color: 'text-blue-700', label: 'LinkedIn' },
                { key: 'instagram', icon: 'fab fa-instagram', color: 'text-pink-500', label: 'Instagram' },
                { key: 'behance', icon: 'fab fa-behance', color: 'text-blue-800', label: 'Behance' },
                { key: 'youtube', icon: 'fab fa-youtube', color: 'text-red-600', label: 'YouTube' },
                { key: 'facebook', icon: 'fab fa-facebook', color: 'text-blue-600', label: 'Facebook' },
            ];
            socialMap.forEach(map => {
                const url = contactData.socialMedia[map.key];
                if (url && (url.startsWith('http://') || url.startsWith('https://'))) {
                    const linkWrapper = document.createElement('a');
                    linkWrapper.className = `p-1 rounded-full transition-transform hover:scale-110 hover:shadow-md`;
                    linkWrapper.href = url;
                    linkWrapper.target = "_blank";
                    linkWrapper.title = map.label;
                    const iconElement = document.createElement('i');
                    iconElement.className = `${map.icon} text-xl ${map.color}`; 
                    linkWrapper.appendChild(iconElement);
                    socialLinksContainer.appendChild(linkWrapper);
                }
            });
            const webLinksList = document.getElementById('web-links-list');
            const mainWebLinkBlock = document.getElementById('main-web-link-block');
            webLinksList.innerHTML = ''; 
            if (contactData.webLinks && contactData.webLinks.length > 0) {
                mainWebLinkBlock.classList.remove('hidden');
                contactData.webLinks.slice(0, 2).forEach(link => {
                    const linkElement = document.createElement('a');
                    linkElement.href = link.href;
                    linkElement.target = "_blank";
                    linkElement.textContent = link.text || link.href; 
                    linkElement.className = 'contact-link text-center w-full hover:underline mt-0 mb-0';
                    webLinksList.appendChild(linkElement);
                });
            } else {
                mainWebLinkBlock.classList.add('hidden');
            }
            renderQrCode('qr-code-profile-canvas', contactData.qrCodeUrl, 'Check Profile');
            renderQrCode('qr-code-wechat-canvas', contactData.wechatQrCodeUrl, 'We chat');
            const logosContainer = document.getElementById('brand-logos-container');
            const logosLinksContainer = document.getElementById('brand-logos-links');
            logosLinksContainer.innerHTML = '';
            const brandLogosTitle = logosContainer.querySelector('p');
            if (brandLogosTitle) brandLogosTitle.style.display = 'none'; 
            if (contactData.brandLogoLinks && contactData.brandLogoLinks.length > 0) {
                logosContainer.classList.remove('hidden');
                contactData.brandLogoLinks.forEach(logo => {
                    if (logo.url && (logo.url.startsWith('http://') || logo.url.startsWith('https://'))) {
                        const logoWrapper = document.createElement('div');
                        logoWrapper.className = 'logo-link';
                        const img = document.createElement('img');
                        img.src = logo.url;
                        img.alt = logo.alt || 'Brand Logo';
                        img.title = logo.alt || 'Brand Logo';
                        logoWrapper.appendChild(img);
                        logosLinksContainer.appendChild(logoWrapper);
                    }
                });
            } else {
                 logosContainer.classList.add('hidden');
            }
        }
        function parseExcelData(data) {
            const contactData = {
                webLinks: [],
                socialMedia: {},
                brandLogoLinks: [],
                bio: ''
            };
            try {
                const workbook = XLSX.read(data, { type: 'binary' });
                const sheetName = workbook.SheetNames[0];
                const sheet = workbook.Sheets[sheetName];
                const dataMatrix = XLSX.utils.sheet_to_json(sheet, { header: 1, raw: false });
                if (dataMatrix.length < 2) {
                    return { contactData };
                }
                const rawHeaders = dataMatrix[0].map(h => String(h).trim());
                const dataValues = dataMatrix[1].map(v => String(v).trim());
                const getVal = (headerName) => {
                    const normalizedTargetKey = headerName.toLowerCase().replace(/[^a-z0-9]/g, '');
                    const index = rawHeaders.findIndex(h => String(h).toLowerCase().replace(/[^a-z0-9]/g, '') === normalizedTargetKey);
                    return index !== -1 ? (dataValues[index] || '').trim() : '';
                };
                contactData.name = getVal('name');
                contactData.title = getVal('title');
                contactData.mainImageURI = getVal('mainImageURI');
                contactData.emailAddress = getVal('emailAddress');
                contactData.qrCodeUrl = getVal('qrCodeUrl');
                contactData.wechatQrCodeUrl = getVal('WeChatQR');
                contactData.headerBG = getVal('headerBG');
                contactData.bio = getVal('Bio');
                ['linkedin', 'instagram', 'behance', 'youtube', 'facebook'].forEach(key => {
                    contactData.socialMedia[key] = getVal(key);
                });
                for (let i = 1; i <= 2; i++) {
                    const text = getVal(`webLink${i}_text`); 
                    const href = getVal(`webLink${i}_href`);
                    if (href && (href.startsWith('http://') || href.startsWith('https://'))) {
                        contactData.webLinks.push({ text: text || href, href });
                    }
                }
                let rawWhatsappNumber = getVal('whatsappNumber');
                if (rawWhatsappNumber) {
                    let cleanedNumber = rawWhatsappNumber.replace(/[^0-9]/g, '');
                    if (!rawWhatsappNumber.startsWith('+')) {
                        cleanedNumber = '+' + cleanedNumber;
                    }
                    if (cleanedNumber.length >= 10) {
                         contactData.whatsappNumber = cleanedNumber.replace(/(\+\d{3})(\d{4})(\d+)/, '$1 $2 $3');
                    } else {
                        contactData.whatsappNumber = cleanedNumber.length > 0 ? cleanedNumber : '';
                    }
                    if(cleanedNumber.length > 1) {
                        contactData.whatsappUrl = `https://wa.me/${cleanedNumber.replace('+', '').replace(/\s/g, '')}`; 
                    } else {
                        contactData.whatsappUrl = '';
                    }
                }
                contactData.wechatUrl = contactData.wechatQrCodeUrl ? 'javascript:void(0)' : '';
                let rawLogos = getVal('Brandlogos'); 
                if (rawLogos) {
                    rawLogos.split(',').forEach(item => {
                        const parts = item.trim().split('|');
                        if (parts.length >= 1) { 
                            const url = parts[0].trim();
                            const alt = parts.length > 1 ? parts[1].trim() : 'Brand Logo';
                            if (url.startsWith('http://') || url.startsWith('https://')) {
                                contactData.brandLogoLinks.push({ url, alt });
                            }
                        }
                    });
                }
                return { contactData };
            } catch (e) {
                console.error("Error during Excel Parsing:", e);
                return { contactData: { name: 'Parsing Error' } };
            }
        }
        window.onload = async function() {
            try {
                const dataUrl = 'https://raw.githubusercontent.com/Rmoosa2014/Resume/main/ContactData.xlsx'; 
                const response = await fetch(dataUrl);
                if (!response.ok) {
                    throw new Error(`Failed to load data file. Status: ${response.status} ${response.statusText}.`);
                }
                const arrayBuffer = await response.arrayBuffer();
                const data = new Uint8Array(arrayBuffer);
                let binaryString = '';
                for (let i = 0; i < data.length; i++) {
                    binaryString += String.fromCharCode(data[i]);
                }
                const { contactData } = parseExcelData(binaryString);
                appContactData = contactData;
                if (appContactData.name) {
                    setupLandingPage(appContactData);
                } else {
                    throw new Error("Excel sheet loaded, but 'name' field is missing or empty.");
                }
            } catch (error) {
                console.error("Error loading and processing data:", error);
                document.getElementById('app-frame').innerHTML = `
                    <div class="p-6 text-center text-red-700 bg-white rounded-xl shadow-lg m-4">
                        <strong class="text-xl">⚠️ Content Error ⚠️</strong>
                        <p class="text-sm text-gray-600 mt-3">Could not load portfolio data.</p>
                        <p class="text-xs text-gray-500 mt-4">Details: ${error.message}</p>
                    </div>
                `;
            }

            document.getElementById('qr-modal').addEventListener('click', function(e) {
                if (e.target.id === 'qr-modal') {
                    hideQrModal();
                }
            });
            document.getElementById('qr-modal-close-btn').addEventListener('click', hideQrModal);

            document.getElementById('profile-modal').addEventListener('click', function(e) {
                if (e.target.id === 'profile-modal') {
                    hideProfileModal();
                }
            });
            document.getElementById('profile-modal-close-btn').addEventListener('click', hideProfileModal);
            document.getElementById('qr-copy-btn').addEventListener('click', copyQrLink);
            document.getElementById('qr-share-btn').addEventListener('click', shareQrLink);
        };

        function copyQrLink() {
            if (!currentModalQrUrl) return;
            const textArea = document.createElement("textarea");
            textArea.value = currentModalQrUrl;
            textArea.style.position = "fixed";
            textArea.style.left = "-9999px";
            document.body.appendChild(textArea);
            textArea.focus();
            textArea.select();
            try {
                document.execCommand('copy');
                const msg = document.getElementById('copy-success-msg');
                msg.classList.remove('hidden');
                setTimeout(() => { msg.classList.add('hidden'); }, 2000);
            } catch (err) {
                console.error('Failed to copy text: ', err);
            }
            document.body.removeChild(textArea);
        }

        async function shareQrLink() {
            if (!currentModalQrUrl || !navigator.share) return;

            const modalCanvas = document.getElementById('modal-qr-canvas');
            if (!modalCanvas) return;

            try {
                const blob = await new Promise(resolve => modalCanvas.toBlob(resolve, 'image/png'));
                const file = new File([blob], 'qrcode.png', { type: 'image/png' });

                if (navigator.canShare && navigator.canShare({ files: [file] })) {
                    await navigator.share({
                        files: [file],
                        title: 'Check Profile',
                        text: `Here's the link: ${currentModalQrUrl}`,
                        url: currentModalQrUrl,
                    });
                } else {
                    await navigator.share({
                        title: 'Check Profile',
                        text: 'Here is the link I wanted to share:',
                        url: currentModalQrUrl,
                    });
                }
            } catch (err) {
                console.error('Error sharing: ', err);
            }
        }

        function showProfileModal() {
            const modal = document.getElementById('profile-modal');
            if (!modal) return;
            const modalImg = document.getElementById('modal-profile-img');
            const modalName = document.getElementById('modal-profile-name');
            const modalTitle = document.getElementById('modal-profile-title');
            const modalNumber = document.getElementById('modal-profile-number');
            const bioContainer = document.getElementById('modal-profile-bio-container');
            const bioText = document.getElementById('modal-profile-bio');

            modalImg.src = document.getElementById('main-profile-img').src;
            modalName.textContent = document.getElementById('profile-name').textContent;
            modalTitle.textContent = document.getElementById('profile-title').textContent;
            
            const numberLink = document.getElementById('primary-contact-number-link');
            const numberSpan = document.getElementById('primary-contact-number');
            modalNumber.textContent = numberSpan.textContent;
            modalNumber.href = numberLink.href;

            if (appContactData.bio) {
                bioText.textContent = appContactData.bio;
                bioContainer.classList.remove('hidden');
            } else {
                bioText.textContent = '';
                bioContainer.classList.add('hidden');
            }
            
            modal.classList.remove('hidden');
        }
    </script>
</body>
</html>